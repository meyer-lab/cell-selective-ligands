## Materials and Methods

### Data and Software Availability

All analysis was implemented in Python v3.8, and can be found at <https://github.com/meyer-lab/cell-selective-ligands>.

### Generalized multi-ligand, multi-receptor multivalent binding model

To model multivalent ligand complexes, we extended our previous binding model [@pmid:29960887]. We define $N_L$ as the number of distinct monomer ligands, $N_R$ the number of distinct receptors, and the association constant of monovalent binding between ligand $i$ and receptor $j$ as $K_{a,ij}$. Multivalent binding interactions after the initial interaction have an association constant of $K_x^* K_{a,ij}$, proportional to their corresponding monovalent affinity. The concentration of complexes is $L_0$, and the complexes consist of random ligand monomer assortments accoring to their relative proportion. The proportion of ligand $i$ in all monomers is $C_i$. By this setup, we know $\sum_{i=1}^{N_L} C_i = 1$. $R_{\mathrm{tot},i}$ is the total number of receptor $i$ expressed on the cell surface, and $R_{\mathrm{eq},i}$ the number of unbound receptors $i$ on a cell at the equilibrium state during the ligand complex-receptor interaction.

The binding configuration at the equilibrium state between an individual complex and a cell expressing various receptors can be described as a vector $\mathbf{q} = (q_{1,0}, q_{1,1}, ..., q_{1,N_R}, q_{2,0},..., q_{2,N_R},q_{3,0},..., q_{N_L, N_R})$ of length $N_L(N_R+1)$, where $q_{i,j}$ is the number of ligand $i$ bound to receptor $j$, and $q_{i,0}$ is the number of unbound ligand $i$ on that complex in this configuration. The sum of elements in $\mathbf{q}$ is equal to $f$ , the effective avidity. For all $i$ in $\{1,2,..., N_L\}$, let $φ_{i,j} = R_{\mathrm{eq},j} K_{a,ij} K_x^* C_i$ when $j$ is in $\{1,2,...,N_R\}$, and $φ_{i,0} = C_i$. The relative amount of complexes in the configuration described by $\mathbf{q}$ at equilibrium is

{% raw %}
$$v_{\mathbf{q},eq} = \binom{f}{\mathbf{q}} \frac{L_0}{K_x^* } \prod_{i=1\\ j=0}^{i=N_L\\ j=N_R}{{φ_{ij}}^{q_{ij}}},$$
{% endraw %}

with $\binom{f}{\mathbf{q}}$ being the multinomial coefficient. Then the total relative amount of bound receptor type $n$ at equilibrium is

{% raw %}
$$ R_{\mathrm{bound},n} = \frac{L_0 f}{K_x^* } \sum_{m=0}^{N_L}φ_{mn} \left(\sum_{i=1\\ j=0}^{i=N_L\\ j=N_R}{{φ_{ij}}^{q_{ij}}}\right)^{f-1} .$$
{% endraw %}

By conservation of mass, we know that $R_{\mathrm{tot},n} = R_{\mathrm{eq},n} + R_{\mathrm{bound},n}$ for each receptor type $n$, while $R_{\mathrm{bound},n}$ is a function of $R_{\mathrm{eq},n}$. Therefore, each $R_{\mathrm{eq},n}$ can be solved numerically from its $R_{\mathrm{tot},n}$ measured experimentally. Similarly, the total relative amount of complexes bind to at least one receptor on the cell is

{% raw %}
$$ L_{\mathrm{bound}} = \frac{L_0}{K_x^* } \left [\left(\sum_{i=1\\ j=0}^{i=N_L\\ j=N_R}{{φ_{ij}}^{q_{ij}}}\right)^f -1 \right] .$$
{% endraw %}

### Generalized multivalent binding model with non-random complexes

When complexes are engineered and so ligands are not randomly sorted into multivalent complexes, such as with the Fabs of bispecific antibodies, the proportions of each kind of complexes become exogenous variables and are no longer decided by the monomer composition $C_i$'s. The monomer composition of a ligand complex can be represented by a vector $\mathbf{θ} = (θ_1, θ_2, ..., θ_{N_L})$, where each $θ_i$ is the number of monomer ligand type $i$ on that complex. Let $C_{\mathbf{θ}}$ be the proportion of the $\mathbf{θ}$ complexes in all ligand complexes, and $Θ$ be the set of all possible $\mathbf{θ}$'s. We have $\sum_{\mathbf{θ} \in Θ} C_{\mathbf{θ}} = 1$.

The binding between a ligand complex and a cell expressing several types of receptors can still be represented by a series of $q_{ij}$ aforementioned. The relationship between $q_{ij}$'s and $θ_i$ is given by $θ_i = q_{i0} + q_{i1} + ... + q_{iN_R}$. Let the vector $\mathbf{q}_i = (q_{i0}, q_{i1}, ..., q_{iN_R})$, and the corresponding $\mathbf{θ}$ of a binding configuration $\mathbf{q}$ be $\mathbf{θ}(\mathbf{q})$. For all $i$ in $\{1,2,...,N_L\}$, we define $ψ_{ij} = R_{\mathrm{eq},j} K_{a,ij} K_x^*$ where $j = \{1,2,...,N_R\}$ and $ψ_{i0} = 1$. The relative amount of complexes bound to a cell with configuration $\mathbf{q}$ at equilibrium is

{% raw %}
$$v_{\mathbf{q},eq} = \frac{L_0 C_{\mathbf{θ}(\mathbf{q})}}{K_x^* }
\prod_{i=1\\j=0}^{i=N_L\\ j=N_R} {ψ_{ij}}^{q_{ij}}
\prod_{i=1}^{N_L} \binom{θ_i}{\mathbf{q}_i} .$$
{% endraw %}

Then we can calculate the relative amount of bound receptor $n$ as

{% raw %}
$$
R_{\mathrm{bound},n} = \frac{L_0}{K_x^* } \sum_{\mathbf{θ} \in Θ} C_{\mathbf{θ}}
\left[ \sum_{i=1}^{N_L} \frac{ψ_{in} θ_i}{\sum_{j=0}^{N_R} ψ_{ij}} \right]
\prod_{i=1}^{N_L} \left( \sum_{j=0}^{N_R} ψ_{ij}\right)^{θ_i} .
$$
{% endraw %}

By $R_{\mathrm{tot},n} = R_{\mathrm{eq},n} + R_{\mathrm{bound},n}$, we can solve $R_{\mathrm{eq},n}$ numerically for each type of receptor.

The total relative amount of ligand binding at equilibrium is

{% raw %}
$$ L_{\mathrm{bound}} =  \frac{L_0}{K_x^* } \sum_{\mathbf{θ} \in Θ} C_{\mathbf{θ}}
\left[ \prod_{i=1}^{N_L} \left( \sum_{j=0}^{N_R} ψ_{ij}\right)^{θ_i} -1 \right] .$$
{% endraw %}

